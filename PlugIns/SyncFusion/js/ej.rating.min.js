/*!
*  filename: ej.rating.min.js
*  version : 11.2.0.63
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t){t.widget("ejRating","ej.Rating",{_rootCSS:"e-rating",element:null,model:null,defaults:{maxValue:5,minValue:0,currentValue:1,allowReset:!0,shapeWidth:23,shapeHeight:23,orientation:"horizontal",incrementStep:1,readOnly:!1,showTooltip:!0,precision:"full",cssClass:"",width:null,height:null,click:null,mouseOver:null,mouseOut:null,valueChanged:null},dataTypes:{maxValue:"number",minValue:"number",currentValue:"number",allowReset:"boolean",shapeWidth:"number",shapeHeight:"number",orientation:"enum",incrementStep:"number",readOnly:"boolean",precision:"enum"},setWidth:function(){},_init:function(){this._initialize()},_setModel:function(n){for(var t in n)switch(t){case"allowReset":n[t]?this.showResetButton():this.hideResetButton();break;case"currentValue":this.setCurrentValue(n[t]);break;case"readOnly":this._unWireEvents();break;case"orientation":this.model.orientation=n[t],this.refresh();break;case"shapeWidth":this.model.shapeWidth=n[t],this.refresh();break;case"shapeHeight":this.model.shapeHeight=n[t],this.refresh()}},_destroy:function(){this.element.show(),this._unWireEvents(),this._mainDiv.remove()},_initialize:function(){this.element.hide(),this._mainDiv=t.buildTag("div.e-rating "+this.model.cssClass),t.isNullOrUndefined(this.model.width)||this._mainDiv.width(this.model.width),t.isNullOrUndefined(this.model.height)||this._mainDiv.height(this.model.height),this._mainDiv.insertBefore(this.element),this.model.orientation==t.orientation.Horizontal?this._mainDiv.addClass("horizontal"):this._mainDiv.addClass("vertical"),this.model.allowReset&&!this.model.readOnly&&this._createReset(),this._validation(),this._renderShape(),this._shapes=this._mainDiv.find("div.shape"),this._wireEvents(),this._CurrentIndex=0,this._initCurrentValue()},_validation:function(){this.model.incrementStep<1?this.model.incrementStep=1:this.model.incrementStep>this.model.maxValue&&(this.model.incrementStep=this.model.maxValue)},_createReset:function(){this._mainDiv.find("div.reset").length<=0?t.buildTag("div.reset","",{width:this.model.shapeWidth+"px",height:this.model.shapeHeight}).appendTo(this._mainDiv):this._mainDiv.find("div.reset").show()},_renderShape:function(){var n=Math.round(this.model.maxValue/this.model.incrementStep),i,r,u,f,e;if(this.model.orientation==t.orientation.Horizontal?(i=(n+1)*this.model.shapeWidth,r=this.model.shapeHeight):this.model.orientation==t.orientation.Vertical&&(i=this.model.shapeWidth,r=this.model.shapeHeight*n),n>0){for(u=t.buildTag("ul.shape-container","",{width:i+"px",height:r}),f=0;f<n;f++)e=t.buildTag("li.shape-list","",{width:this.model.shapeWidth+"px",height:this.model.shapeHeight}),t.buildTag("div.shape inactive","",{width:this.model.shapeWidth+"px",height:this.model.shapeHeight}).appendTo(e),e.appendTo(u);u.appendTo(this._mainDiv)}},_initCurrentValue:function(){var i=this.model.currentValue/this.model.incrementStep,t;for(this._CurrentIndex=i,this._valueRefresh(this._CurrentIndex),t=0;t<i;t++)this._shapes[t]&&n(this._shapes[t]).removeClass("inactive").removeClass("active").addClass("selected")},_valueRefresh:function(i){var r,u;if(i=Math.round(i),r=(this.model.currentValue/this.model.incrementStep).toFixed(1),this.model.orientation==t.orientation.Horizontal){for(r=((r%1).toFixed(1)!=0?(r%1).toFixed(1):r/this._CurrentIndex)*this.model.shapeWidth,u=0;u<i;u++)n(this._shapes[u]).css({width:this.model.shapeWidth+"px"});this._shapes!=null&&n(this._shapes[i-1]).css({width:r+"px"})}else{for(r=((r%1).toFixed(1)!=0?(r%1).toFixed(1):r/this._CurrentIndex)*this.model.shapeHeight,u=0;u<i;u++)n(this._shapes[u]).css({height:this.model.shapeHeight+"px"});this._shapes!=null&&n(this._shapes[i-1]).css({height:r+"px"})}},_reset:function(){n(this._shapes).removeClass("active").removeClass("selected").addClass("inactive"),this.model.currentValue=0,this._CurrentIndex=0,this.element.value=this._CurrValue,this._valueChanged()},_fillExactPrecision:function(i,r){var e=this._shapes.index(i)+1,f=this.model,u;if(f.orientation==t.orientation.Horizontal){for(u=0;u<this._shapes.length;u++)u<e?n(this._shapes[u]).css({width:f.shapeWidth+"px"}):n(this._shapes[u]).css({width:"0px"});n(i).css({width:r+"px"}),this.toolTipValue=((e-1)*f.incrementStep+r/f.shapeWidth*f.incrementStep).toFixed(1)}else{for(u=0;u<e;u++)n(this._shapes[u]).css({height:f.shapeHeight+"px"});for(u=e;u<this._shapes.length;u++)n(this._shapes[u]).css({height:"0px"});n(i).css({height:r+"px"}),this.toolTipValue=((e-1)*f.incrementStep+r/f.shapeHeight*f.incrementStep).toFixed(1)}},_fillHalfPrecision:function(i,r){var e=this._shapes.index(i)+1,u=this.model,f;if(u.orientation==t.orientation.Horizontal){for(f=0;f<this._shapes.length;f++)f<e?n(this._shapes[f]).css({width:u.shapeWidth+"px"}):n(this._shapes[f]).css({width:"0px"});(r+1)%2==0?(r=u.shapeWidth/2,n(i).css({width:r+"px"}),this.toolTipValue=((e-1)*u.incrementStep+r/u.shapeWidth*u.incrementStep).toFixed(1)):(r=u.shapeWidth,n(i).css({width:r+"px"}),this.toolTipValue=((e-1)*u.incrementStep+r/u.shapeWidth*u.incrementStep).toFixed(1))}else{for(f=0;f<this._shapes.length;f++)f<e?n(this._shapes[f]).css({height:this._starHeight+"px"}):n(this._shapes[f]).css({height:"0px"});r<=u.shapeHeight/2?(r=u.shapeHeight/2,n(i).css({height:r+"px"}),this.toolTipValue=((e-1)*u.incrementStep+r/u.shapeHeight*u.incrementStep).toFixed(1)):(r=u.shapeHeight,n(i).css({height:r+"px"}),this.toolTipValue=((e-1)*u.incrementStep+r/u.shapeHeight*u.incrementStep).toFixed(1))}},_ClickHandler:function(i){var r,e,u,f,o;if(i.target.tagName=="LI"?r=i.target.firstChild:i.target.parentNode.tagName=="LI"&&(r=i.target),r){for(e=this._shapes.index(r)+1,u=0;u<e;u++)this._shapes[u]&&n(this._shapes[u]).removeClass("inactive").removeClass("active").addClass("selected");this._CurrentIndex=e,f=this.model.incrementStep,o=this.model.orientation==t.orientation.Horizontal?((this._CurrentIndex-1)*f+r.clientWidth/this.model.shapeWidth*f).toFixed(1):((this._CurrentIndex-1)*f+r.clientHeight/this.model.shapeHeight*f).toFixed(1),this.element.value=o,this.model.currentValue=o,this.model.click&&this._trigger("click",{event:i,Value:this.model.currentValue}),this._valueChanged()}n(i.target).hasClass("reset")&&this._reset()},_MouseOverHandler:function(t){var r,u,i;if(t.target.tagName=="LI")r=t.target.firstChild;else if(t.target.parentNode.tagName=="LI")r=t.target;else return!1;for(u=this._shapes.index(r)+1,i=0;i<=this._shapes.length;i++)this._shapes[i]&&(i<u?n(this._shapes[i]).removeClass("inactive").removeClass("selected").addClass("active"):n(this._shapes[i]).removeClass("active").removeClass("selected").addClass("inactive"));this.model.mouseOver&&this._trigger("mouseOver",{event:t,index:u,Value:this.model.currentValue})},_MouseOutHandler:function(i){var u,r;if(!this.model.readOnly){if(u=this._CurrentIndex,u!=0)for(r=0;r<this._shapes.length;r++)this._shapes[r]&&(r<u?n(this._shapes[r]).removeClass("active").removeClass("inactive").addClass("selected"):n(this._shapes[r]).removeClass("active").addClass("inactive"));else n(this._shapes).removeClass("active").addClass("inactive");this.model.precision!==t.Rating.Precision.Full&&this._valueRefresh(u),this.model.mouseOut&&this._trigger("mouseOut",{event:i,Value:this.model.currentValue})}this._hideTooltip(1e3)},_MouseMoveHandler:function(i){if(this.model.readOnly)this.toolTipValue=this.model.currentValue+" / "+this.model.maxValue;else{var r,u;if(i.target.tagName=="LI")r=i.target.firstChild;else if(i.target.parentNode.tagName=="LI")r=i.target;else return!1;u=this.model.orientation==t.orientation.Horizontal?t.isNullOrUndefined(i.offsetX)?i.pageX-n(i.target).offset().left:i.offsetX+1:t.isNullOrUndefined(i.offsetY)?i.pageY-n(i.target).offset().top:i.offsetY+1,this.toolTipValue=this._shapes.index(r)+1,this.model.precision==t.Rating.Precision.Exact?this._fillExactPrecision(r,u):this.model.precision==t.Rating.Precision.Half&&this._fillHalfPrecision(r,Math.round(u))}this._showhideTooltip(i.target)},_showTooltip:function(i){this.model.showTooltip&&(n(".e-rating-tooltip").remove(),this.tooltip=t.buildTag("div.e-rating-tooltip "+this.model.cssClass+" e-corner-all"),n("body").append(this.tooltip),this._isTooltip=!0,this._setTooltipPosition(i))},_hideTooltip:function(t){this.model.showTooltip&&(n(this.tooltip).fadeOut(t,function(){n(".e-rating-tooltip").remove()}),this._isTooltip=!1)},_showhideTooltip:function(n){this.model.showTooltip&&this._showTooltip(n)},_setTooltipPosition:function(t){if(this.model.showTooltip){this._updateTooltipValue();var f,e,r,u,i,o=5;i=n(t),this.model.orientation=="vertical"?(u=(this.tooltip[0].offsetHeight-i[0].offsetHeight)/2,r=i[0].offsetWidth+o,f=i.offset().top-u,e=i.offset().left+r):(r=(this.tooltip[0].offsetWidth-i[0].offsetWidth)/2,u=this.tooltip[0].offsetHeight+o,f=i.offset().top-u,e=i.offset().left-r),this.tooltip.css({top:f,left:e})}},_updateTooltipValue:function(){this.tooltip[0].innerHTML=this.toolTipValue},_wireEvents:function(){this.model.readOnly||(this._on(this._mainDiv,"mousedown",this._ClickHandler),this._on(this._mainDiv.find("li"),"mouseenter",this._MouseOverHandler)),this._on(this._mainDiv.find("li"),"mouseleave",this._MouseOutHandler),this._on(this._mainDiv.find("li"),"mousemove",this._MouseMoveHandler)},_unWireEvents:function(){this._mainDiv.find("li").unbind("mouseenter"),this._mainDiv.find("li").unbind("mouseleave"),this._mainDiv.unbind("mousedown"),this.model.precision!==t.Rating.Precision.Full&&this._mainDiv.find("li").unbind("mousemove")},_valueChanged:function(){this.model.valueChanged&&this._trigger("valueChanged",{Value:this.model.currentValue})},reset:function(){this._reset()},showRating:function(){this._mainDiv.css("visibility","visible")},hideRating:function(){this._mainDiv.css("visibility","hidden")},showResetButton:function(){this._createReset()},hideResetButton:function(){this._mainDiv.find("div.reset").hide()},getCurrentValue:function(){return this.model.currentValue},setCurrentValue:function(t){t!=null&&(this.model.currentValue=t,n(this._shapes).removeClass("selected").addClass("inactive"),this._initCurrentValue())},refresh:function(){this._destroy(),this._unWireEvents(),this._initialize()}}),t.Rating.Precision={Full:"full",Half:"half",Exact:"exact"}})(jQuery,Syncfusion)