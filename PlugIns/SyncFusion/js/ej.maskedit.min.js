/*!
*  filename: ej.maskedit.min.js
*  version : 11.2.0.63
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t,i){t.widget("ejMaskEdit","ej.MaskEdit",{element:null,model:null,defaults:{mask:"",value:"",waterMarkText:null,height:"20px",width:"auto",error:!1,cssClass:"",customChar:null,inputMode:"text",textAlign:t.textAlign.Left,hidePromptOnLeave:!1,onKeyDown:null,roundedCorner:null,keyUp:null,keyPress:null,valueChange:null,mouseOver:null,mouseOut:null,focusIn:null,focusOut:null},dataTypes:{mask:"string",value:"string",error:"boolean",customChar:"string",inputMode:"enum",textAlign:"enum",hidePromptOnLeave:"boolean"},enable:function(){this.element.disabled=!1,this.element.removeAttr("disabled").removeClass("e-state-disabled")},disable:function(){this.element.disabled=!0,this.element.attr("disabled","disabled").addClass("e-state-disabled")},_setWidth:function(n){this.element.width(n)},_setHeight:function(n){this.element.height(n)},_roundedCorner:function(n){n?this.element.addClass("e-corner-all"):this.element.hasClass("e-corner-all")&&this.element.removeClass("e-corner-all")},_setTextAlign:function(n){n=="right"?this.element.css("padding-right","2px"):this.element.css("padding-right",""),this.element.css("text-align",n)},_setInputMode:function(n){this.element.attr("type",n)},_init:function(){if(this.element.is("input[type=text]")||this.element.attr("type")==i)this._setValues(),this._renderControl(),this._initObjects(),this._wireEvents();else return this._destroy(),!1},_setValues:function(){this._tempMask=null,this._unStrippedMask=null,this._charMap={"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]",A:"[A-Za-z]",N:"[0-9]","<":"",">":"",C:"","?":"(.)",$:"[A-Za-z ]"}},_destroy:function(){this.model.name&&this.element.removeAttr("name"),this.model.height&&this.element.height(""),this.model.textAlign&&this.element.css("text-align",""),this.element.val("").removeClass("e-input e-corner-all e-state-disabled e-watermark").empty()},_setModel:function(n){if(this.element.hasClass("e-state-disabled"))return!1;for(var t in n)switch(t){case"value":this._setValue(n[t]);break;case"width":this._setWidth(n[t]);break;case"height":this._setHeight(n[t]);break;case"waterMarkText":this.model.waterMarkText=n[t],this._setWaterMark();break;case"roundedCorner":this._roundedCorner(n[t]);break;case"textAlign":this._setTextAlign(n[t]);break;case"inputMode":this._setInputMode(n[t]);break;case"mask":this._setMask(n[t]);break;case"cssClass":this._setSkin(n[t])}},_renderControl:function(){this.model.name=this.model.name!=null?this.model.name:this.element[0].id,this.element.attr("name",this.model.name).addClass(" e-maskwidget e-input "+this.model.cssClass),this._setInputMode(this.model.inputMode),this._setWidth(this.model.width),this._setHeight(this.model.height),this._roundedCorner(this.model.roundedCorner),this._setTextAlign(this.model.textAlign)},_wireEvents:function(){this._on(this.element,"focus",this._OnFocusHandler),this._on(this.element,"blur",this._OnBlurHandler),this._on(this.element,"keydown",this._OnKeyDownHandler),this._on(this.element,"keypress",this._OnKeyPressHandler),this._on(this.element,"keyup",this._OnKeyUpHandler),this._on(this.element,"mouseover",this._OnMouseOverHandler),this._on(this.element,"mouseout",this._OnMouseOutHandler)},_initObjects:function(){this._textbox=this.element[0],this.model.value==""&&this._textbox.value!=""&&(this.model.value=this._textbox.value),this._keypressFlag=0,this._selectedTextKeyDown=0,this._keydownFlag=0,this._maskLength=this.model.mask.length,this._maskModel=this.model.mask.replace(/[9?$CANa*]/g,"_"),this._validatedValue=this._maskModel,this.model.inputMode!="password"&&(this._validateValue(),this._setWaterMark()),this.model.error&&this.element.addClass("error")},_setSkin:function(n){this.element.removeClass(this.model.cssClass),this.element.addClass(n)},_setWaterMark:function(){this._maskModel=this.model.mask.replace(/[9?$CANa*]/g,"_"),this.model.waterMarkText&&(this.model.value==""||this.model.value==this._maskModel)?(this._textbox.value=this.model.waterMarkText,this.element.addClass("e-watermark")):this.model.value==""&&this._maskModel!=""&&(this._textbox.value=this._maskModel)},_removeWaterMark:function(){this.element.hasClass("e-watermark")&&(this._textbox.value=this._maskModel,this.element.removeClass("e-watermark"))},_showAlert:function(){var t=this;this.element.addClass("invalidtext").animate({Opacity:1},700,null,function(){n(t._textbox).removeClass("invalidtext")})},_validateValue:function(){var n,f,e,u;this.model.value=this.model.value.replace(/[^a-zA-Z0-9<>?CAN]/g,"");var i=this.model.value,t=this._maskModel,r=-1;if(this._maskLength==0)return this.element.hasClass("e-watermark")&&this.element.removeClass("e-watermark"),this._textbox.value=i,!0;for(n=0;n<this._maskLength;n++)this._charMap[this.model.mask.charAt(n)]&&(r++,f=i.charCodeAt(r),this._validateChars(f,n)&&(e=t.substring(0,n),u=t.substring(n),t=e+i.charAt(r)+u.substr(1,u.length)));this.element.hasClass("e-watermark")?this.model.value?(this.element.removeClass("e-watermark"),this._textbox.value=t):this._setWaterMark():this._textbox.value=this.model.value?t:this.model.mask.replace(/[9?$CANa*]/g,"_")},_selectionText:function(n,t){var i=this._maskModel.substring(n,t);return(this._textbox.value=this._textbox.value.substring(0,n)+i+this._textbox.value.substring(t),this._keydownFlag==1)?(this._setCaretPosition(n),n):this._keydownFlag==2?(this._setCaretPosition(t),t):n},_caretPosition:function(n){var t=0,i,r;return document.selection?(i=document.selection.createRange(),r=i.text.length,i.moveStart("character",-n.value.length),t=i.text.length-r,r!=0&&(t=this._selectionText(t,i.text.length),this._selectedTextKeyDown=1)):(n.selectionStart||n.selectionStart=="0")&&(t=n.selectionStart,n.selectionStart!=n.selectionEnd&&(t=this._selectionText(n.selectionStart,n.selectionEnd),this._selectedTextKeyDown=1)),t},_setCaretPosition:function(n){var t=this._textbox,i;window.navigator.appName=="Microsoft Internet Explorer"?t.createTextRange&&(i=t.createTextRange(),i.move("character",n),i.select()):t.selectionStart||t.selectionStart=="0"?(t.focus(),t.setSelectionRange(n,n)):t.focus()},_validateChars:function(t,i){var f=this._charMap,e=this.model.mask.substr(i,1),r=this.model.customChar,o=String.fromCharCode(t),u=!1;return n.each(f,function(n,t){e==n&&(r!=null&&(n=="C"?t="["+r+"]":(n=="A"||n=="N")&&(t=t.replace("]","")+r+"]")),u=o.match(new RegExp(t))?!0:!1)}),u},_seekNext:function(){for(var n=this._caretPosition(this._textbox),t=n,i=!0;i;){if(n>=0&&n<this._maskLength&&(this.model.mask.charAt(n)!="C"&&(this._charMap[this.model.mask.charAt(n)]||(this._setCaretPosition(n+1),n++)),n!=t)){t=n;continue}i=!1}return n},_seekBefore:function(){var n=this._caretPosition(this._textbox),i=--n,t=!0;for(this._selectedTextKeyDown==1&&(t=!1);t;){if(n>=0&&n<this._maskLength&&(this._charMap[this.model.mask.charAt(n)]||this._setCaretPosition(--n),n!=i)){i=n;continue}t=!1}return n},_writeBuffer:function(n,t){var r,u,e,f;t<=this._maskLength&&(r=this._textbox.value,this._tempMask!=null&&(u=this._updateCasing(n,t)),n=u==i?n:u,e=r.substring(0,t),f=r.substring(t),this._textbox.value=e+n+f.substr(1,f.length),this._setCaretPosition(t+1),this._raiseEvents("valueChange"))},_updateCasing:function(n,t){for(var r,i=0;i<t+1;i++)(this._tempMask.substr(i,1)=="<"||this._tempMask.substr(i,1)==">")&&t++;for(r=t;r>-1;r--){if(this._tempMask.substr(r,1)=="<")return n.toLowerCase();if(this._tempMask.substr(r,1)==">")return n.toUpperCase()}},get_StrippedValue:function(){var n=this._textbox.value,t="";return n!=i&&(t=n.replace(/[^a-zA-Z0-9<>?CAN]/g,"")),t},get_UnstrippedValue:function(){var n=this._textbox.value,t="";return n!=i&&(t=n.replace(/[_]/g," ")),t},_OnFocusHandler:function(){this._removeWaterMark(),(this._textbox.value.indexOf("<")>=0||this._textbox.value.indexOf(">")>=0)&&(this._textbox.value=this._textbox.value.replace(/[<>]/g,""),this._maskModel=this._textbox.value,this._tempMask=this.model.mask,this.model.mask=this.model.mask.replace(/[<>]/g,"")),this._textbox.value!=this._maskModel&&this._unStrippedMask!=null&&this.model.hidePromptOnLeave&&(this._textbox.value=this._unStrippedMask),n.fn.selectRange=function(n,t){return this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(n,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",n),i.select()}})},this.model.mask&&this.element.selectRange(0,0),this._raiseEvents("focusIn")},_OnBlurHandler:function(){this.model.value=this._textbox.value,this.model.value!=i&&this.model.hidePromptOnLeave&&(this._unStrippedMask=this.model.value,this._textbox.value=this.get_UnstrippedValue()),this.model.inputMode!="password"&&this._setWaterMark(),this._raiseEvents("focusOut")},_OnKeyDownHandler:function(n){var i,r,t;if(this._raiseEvents("onKeyDown"),this.element.removeClass("error"),this._maskLength==0)return!0;if(i=n.keyCode?n.keyCode:n.charCode,r=String.fromCharCode(i),i>=35&&i<=41)(window.navigator.appCodeName=="Mozilla"||window.navigator.appCodeName=="opera")&&(this._keypressFlag=1);else{if(i==8)return this._keydownFlag=1,t=this._seekBefore(),this._selectedTextKeyDown||(t>=0&&t<this._maskLength&&this._writeBuffer("_",t),this._setCaretPosition(t)),this._keydownFlag=0,this._selectedTextKeyDown=0,n.preventDefault(),!1;if(i==46)return this._keydownFlag=2,t=this._seekNext(),this._selectedTextKeyDown||t>=0&&t<this._maskLength&&this._writeBuffer("_",t),this._keydownFlag=0,this._selectedTextKeyDown=0,n.preventDefault(),!1}},_OnKeyPressHandler:function(n){if(this._raiseEvents("keyPress"),this._maskLength==0)return!0;var t=n.keyCode?n.keyCode:n.charCode,r=String.fromCharCode(t),i=this._seekNext();if(this._validateChars(t,i)?this._writeBuffer(r,i):this._showAlert(),!this._keypressFlag&&t!=9)return this._keypressFlag=0,n.preventDefault(),!1;this._keypressFlag=0},_OnKeyUpHandler:function(){this._raiseEvents("keyUp")},_OnMouseOverHandler:function(){this._raiseEvents("mouseOver")},_OnMouseOutHandler:function(){this._raiseEvents("mouseOut")},_raiseEvents:function(n){var t;this.model[n]&&(t={strippedValue:this.get_StrippedValue(),unStrippedValue:this.get_UnstrippedValue()},this._trigger(n,t))},_OnValueChange:function(){this._textbox.value==""&&this._maskModel!=""&&(this._textbox.value=this._maskModel),this._setValue(this._textbox.value)},clear:function(){this._textbox.value=this.model.mask.replace(/[9?$aCAN*]/g,"_")},_setValue:function(n){this.model.value=n,this._validateValue()},_setMask:function(n){this._maskLength=n.length,this.model.mask=n,this._maskModel=n.replace(/[9?$CANa*]/g,"_"),this._validateValue()}}),t.inputMode={Password:"password",Text:"text"}})(jQuery,Syncfusion)