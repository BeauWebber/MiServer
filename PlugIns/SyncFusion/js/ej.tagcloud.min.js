/*!
*  filename: ej.tagcloud.min.js
*  version : 11.2.0.63
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t,i){t.widget("ejTagCloud","ej.TagCloud",{element:{target:null},model:null,_rootCSS:"e-tagcloud",defaults:{cssClass:"",dataSource:null,query:null,fields:null,showTitle:!0,title:"Title",titleImage:null,format:"cloud",rtl:!1,minFontSize:"10px",maxFontSize:"40px",mouseover:null,mouseout:null,click:null},dataTypes:{cssClass:"string",showTitle:"boolean",title:"string",titleImage:"string",format:"enum",rtl:"boolean"},_init:function(){this._initialize(),this._render()},_setModel:function(n){var t;for(t in n)switch(t){case"dataSource":this._modifySourceItems(n[t]);break;case"minFontSize":this.model.minFontSize=n[t],this._modifySourceItems(this.model.dataSource);break;case"maxFontSize":this.model.maxFontSize=n[t],this._modifySourceItems(this.model.dataSource);break;case"title":this._title(n[t]);break;case"cssClass":this._changeSkin(n[t]);break;case"format":this._format(n[t]);break;case"rtl":this._rtl(n[t])}},_modifySourceItems:function(n){this.ul.remove(),this._checkDataBinding(n)},_title:function(n){this.model.showTitle&&this.title.find("span")[0]&&(this.title.find("span")[0].innerHTML=n)},_changeSkin:function(n){this.model.cssClass!=n&&this.element.removeClass(this.model.cssClass).addClass(n)},insert:function(t){n.trim(t.text)&&(t=this._setTagFrequency(t),this.ul.append(this._generateLi(t,this._getMapper())))},insertAt:function(t,i){n.trim(t.text)&&(t=this._setTagFrequency(t),n(this.ul.children()[i-1]).before(this._generateLi(t,this._getMapper())))},remove:function(t){for(var u=this.ul.children(),r,i=0;i<u.length;i++)r=n(u[i]),r.children()[0].innerHTML==t&&r.remove()},removeAt:function(t){var i=this.ul.children();n(i[t-1]).remove()},_format:function(n){n=="cloud"?(this.ul.removeClass("list"),this.ul.addClass("cloud")):n=="list"&&(this.ul.removeClass("cloud"),this.ul.addClass("list"))},_destroy:function(){this.element.removeClass(this.model.cssClass);for(var i=this.element.children(),t=0;t<i.length;t++)n(i[t]).remove()},_initialize:function(){this.minFreq=0,this.maxFreq=30,this.ul=null},_render:function(){this.element.addClass(this.model.cssClass),this.model.showTitle&&(this.title=t.buildTag("h3.title"),this.model.titleImage&&(this.image=n('<img class="titleimage" src="'+this.model.titleImage+'" />'),this.title.append(this.image)),this.model.title&&this.title.append(t.buildTag("span",this.model.title)),this.element.append(this.title)),this._renderWrapper(),this._checkDataBinding(this.model.dataSource),this._checkProperties()},_renderWrapper:function(){var n;n=this.model.format=="list"?"list":"cloud",this.ul=t.buildTag("ul."+n),this.element.append(this.ul)},_renderItems:function(n){this._setFrequency(n),this._generateTagItems(n),this.ul.removeClass("onloading")},_checkProperties:function(){this.model.rtl&&this._rtl(this.model.rtl)},_rtl:function(n){n?this.element.addClass("e-rtl"):this.element.removeClass("e-rtl")},_checkDataBinding:function(n){n!=null&&(this.ul.addClass("onloading"),t.DataManager&&n instanceof t.DataManager?this._initDataSource(n):this._renderItems(n))},_initDataSource:function(n){var t=this,i=n.executeQuery(this._getQuery());i.done(function(n){t._renderItems(n.result)}).fail(function(){t.ul.removeClass("onloading")})},_getQuery:function(){var u;if(t.isNullOrUndefined(this.model.query)){var r=[],i=t.Query(),n=this.model.fields;for(u in n)u!=="tableName"&&r.push(n[u]);r.length>0&&i.select(r),this.model.dataSource.dataSource.url.match(n.tableName+"$")||t.isNullOrUndefined(n.tableName)||i.from(n.tableName)}else i=this.model.query;return i},_setFrequency:function(n){var t;for(this.minFreq=0,this.maxFreq=n.length,t=0;t<n.length;t++)n[t].frequency==null||n[t].frequency==i||n[t].frequency<this.minFreq?n[t].frequency=this.minFreq:n[t].frequency>this.maxFreq&&(this.maxFreq=n[t].frequency)},_setTagFrequency:function(n){return n.frequency==null||n.frequency==i||n.frequency<this.minFreq?n.frequency=this.minFreq:n.frequency>this.maxFreq&&(this.maxFreq=n.frequency),n},_generateTagItems:function(n){for(var i=this._getMapper(),t=0;t<n.length;t++)this.ul.append(this._generateLi(n[t],i))},_getMapper:function(){var n=this.model.fields,t={_text:null,_freq:null,_url:null};return t._text=n&&n.text?n.text:"text",t._freq=n&&n.frequency?n.frequency:"frequency",t._url=n&&n.url?n.url:"url",t},_generateLi:function(n,i){var u=t.buildTag("li.tagitems"),r;return r=t.buildTag("a.text",n[i._text],{"font-size":this._calculateFontSize(n[i._freq])},{href:n[i._url]||"#",target:"blank"}),u.append(r),this._on(r,"mouseenter",this._mouseEnter),this._on(r,"mouseleave",this._mouseLeave),this._on(r,"click",this._mouseClick),u},_mouseEnter:function(t){n(t.target).addClass("hover"),this.model.mouseover&&this._raiseEvent(t,"mouseover")},_mouseLeave:function(t){n(t.target).removeClass("hover"),this.model.mouseout&&this._raiseEvent(t,"mouseout")},_mouseClick:function(t){n(t.target).removeClass("hover"),this.model.click&&this._raiseEvent(t,"click")},_raiseEvent:function(n,t){this._trigger(t,{text:n.target.text,url:n.target.href})},_calculateFontSize:function(n){if(n){var t=this.minFreq,e=this.maxFreq,i=2,r,u,f=parseInt(this.model.minFontSize,10),o=parseInt(this.model.maxFontSize,10);return r=(n-t)/(e-t),u=o-f,f+i*Math.floor(r*(u/i))}return this.model.minFontSize}}),t.format={Cloud:"cloud",List:"list"}})(jQuery,Syncfusion)